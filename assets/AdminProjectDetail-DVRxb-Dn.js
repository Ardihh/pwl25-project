import{_ as P,c as i,a as h,b as t,r as S,t as d,w as k,i as a,v as u,j as V,k as x,n as N,F as M,h as U,u as _,e as c,o as A,f as m,l as B,g as r}from"./index-DLIjiac4.js";import{A as R}from"./AdminNavbar-Isu584Ue.js";const I={components:{AdminNavbar:R},setup(){const f=_(),e=B(),b=f.params.id,o=c({}),v=c([]),p=c(!1),g=c(null),l=c({title:"",description:"",budget:0,deadline:"",status:"planning"}),s=c({title:"",detail:"",priority:3,due_date:"",status:"todo"}),y=async()=>{try{const n=await m.get(`/projects/${b}`);o.value=n.data.project;const C=await m.get(`/tasks/project/${b}`);v.value=C.data.tasks}catch(n){console.error("Error loading project data:",n)}},w=()=>{if(p.value=!p.value,p.value){const n=o.value.deadline?new Date(o.value.deadline).toISOString().split("T")[0]:"";l.value={...o.value,deadline:n}}},j=async()=>{try{const n=await m.put(`/projects/${b}`,l.value);o.value=n.data.project,p.value=!1,alert("Project updated!")}catch{alert("Failed to update project.")}},E=async()=>{confirm("Delete this project?")&&(await m.delete(`/projects/${b}`),e.push("/admin/projects"))},F=n=>{g.value=n.id,s.value={...n}},T=async()=>{try{await m.put(`/tasks/${g.value}`,s.value),await y(),g.value=null}catch{alert("Failed to update task.")}},D=async n=>{confirm("Delete this task?")&&(await m.delete(`/tasks/${n}`),y())};return A(y),{id:b,project:o,tasks:v,isEditing:p,editForm:l,editingTaskId:g,taskEditForm:s,toggleEditMode:w,updateProject:j,deleteProject:E,startEditTask:F,updateTask:T,deleteTask:D}}},O={class:"container mx-auto px-8 py-8 max-w-4xl text-gray-800"},L={class:"mb-6 flex justify-between items-center"},q={class:"text-3xl font-bold"},z={class:"flex gap-2"},H={key:0,class:"bg-white p-6 rounded-xl shadow-lg mb-6 border border-gray-100"},G={class:"grid grid-cols-2 gap-4"},J={class:"flex gap-2 pt-2"},K={key:1,class:"bg-white p-6 rounded-xl shadow-lg mb-6 border border-gray-100"},Q={class:"mb-3 text-gray-600"},W={class:"mb-3"},X={class:"mb-3"},Y={class:"mb-3"},Z={class:"mb-3"},$={class:"flex justify-between items-center mb-4"},tt={key:2,class:"bg-gray-50 p-10 rounded-xl text-center text-gray-500 border-2 border-dashed border-gray-200"},et={key:3,class:"space-y-4"},ot={key:0},lt={class:"flex gap-2"},st={key:1},nt={class:"flex justify-between items-start"},dt={class:"text-lg font-bold"},it={class:"text-gray-600 text-sm mb-2"},rt={class:"flex gap-2"},at=["onClick"],ut=["onClick"],bt={class:"flex gap-4 text-xs font-bold text-gray-500 uppercase"};function pt(f,e,b,o,v,p){const g=S("AdminNavbar");return r(),i("div",null,[h(g),t("div",O,[t("div",L,[t("h2",q,"Project: "+d(o.project.title),1),t("div",z,[t("button",{class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-semibold rounded-lg transition-all duration-200 shadow-md",onClick:e[0]||(e[0]=(...l)=>o.toggleEditMode&&o.toggleEditMode(...l))},d(o.isEditing?"Cancel":"Edit Project"),1),t("button",{class:"px-4 py-2 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white font-semibold rounded-lg transition-all duration-200 shadow-md",onClick:e[1]||(e[1]=(...l)=>o.deleteProject&&o.deleteProject(...l))}," Delete Project ")])]),o.isEditing?(r(),i("div",H,[e[22]||(e[22]=t("h3",{class:"text-xl font-bold mb-4"},"Edit Project Details",-1)),t("form",{onSubmit:e[8]||(e[8]=k((...l)=>o.updateProject&&o.updateProject(...l),["prevent"])),class:"space-y-4"},[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-semibold mb-2"},"Title:",-1)),a(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.editForm.title=l),type:"text",required:"",class:"w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[u,o.editForm.title]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-semibold mb-2"},"Description:",-1)),a(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.editForm.description=l),rows:"3",class:"w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[u,o.editForm.description]])]),t("div",G,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-semibold mb-2"},"Budget:",-1)),a(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.editForm.budget=l),type:"number",class:"w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[u,o.editForm.budget]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-semibold mb-2"},"Deadline:",-1)),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.editForm.deadline=l),type:"date",class:"w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[u,o.editForm.deadline]])])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-semibold mb-2"},"Status:",-1)),a(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.editForm.status=l),class:"w-full px-4 py-2 rounded-lg border focus:ring-2 focus:ring-blue-500 outline-none"},[...e[19]||(e[19]=[t("option",{value:"planning"},"Planning",-1),t("option",{value:"ongoing"},"Ongoing",-1),t("option",{value:"completed"},"Completed",-1),t("option",{value:"on_hold"},"On Hold",-1)])],512),[[V,o.editForm.status]])]),t("div",J,[e[21]||(e[21]=t("button",{type:"submit",class:"px-5 py-2 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700"},"Save Changes",-1)),t("button",{type:"button",onClick:e[7]||(e[7]=(...l)=>o.toggleEditMode&&o.toggleEditMode(...l)),class:"px-5 py-2 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600"},"Cancel")])],32)])):(r(),i("div",K,[t("p",Q,[e[23]||(e[23]=t("span",{class:"font-bold text-gray-800"},"Owner:",-1)),x(" "+d(o.project.owner_name),1)]),t("p",W,[e[24]||(e[24]=t("span",{class:"font-bold"},"Description:",-1)),x(" "+d(o.project.description||"No description"),1)]),t("p",X,[e[25]||(e[25]=t("span",{class:"font-bold"},"Budget:",-1)),x(" Rp "+d(Number(o.project.budget).toLocaleString()),1)]),t("p",Y,[e[26]||(e[26]=t("span",{class:"font-bold"},"Deadline:",-1)),x(" "+d(o.project.deadline||"No deadline"),1)]),t("p",Z,[e[27]||(e[27]=t("span",{class:"font-bold"},"Status:",-1)),t("span",{class:N(["px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider",{"bg-green-100 text-green-800":o.project.status==="completed","bg-blue-100 text-blue-800":o.project.status==="ongoing","bg-yellow-100 text-yellow-800":o.project.status==="planning","bg-red-100 text-red-800":o.project.status==="on_hold"}])},d(o.project.status),3)])])),t("div",$,[e[28]||(e[28]=t("h3",{class:"text-2xl font-bold"},"Tasks",-1)),t("button",{class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg shadow-md",onClick:e[9]||(e[9]=l=>f.$router.push(`/projects/${o.id}/tasks/new`))}," + Add Task ")]),o.tasks.length===0?(r(),i("div",tt," No tasks assigned to this project. ")):(r(),i("div",et,[(r(!0),i(M,null,U(o.tasks,l=>(r(),i("div",{key:l.id,class:"bg-white p-5 rounded-xl shadow border border-gray-100"},[o.editingTaskId===l.id?(r(),i("div",ot,[t("form",{onSubmit:e[14]||(e[14]=k((...s)=>o.updateTask&&o.updateTask(...s),["prevent"])),class:"space-y-3"},[a(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.taskEditForm.title=s),class:"w-full px-3 py-2 border rounded",placeholder:"Task Title"},null,512),[[u,o.taskEditForm.title]]),a(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.taskEditForm.detail=s),class:"w-full px-3 py-2 border rounded",placeholder:"Task Detail"},null,512),[[u,o.taskEditForm.detail]]),a(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.taskEditForm.priority=s),type:"number",min:"1",max:"5",class:"w-full px-3 py-2 border rounded",placeholder:"Priority (1-5)"},null,512),[[u,o.taskEditForm.priority]]),t("div",lt,[e[29]||(e[29]=t("button",{type:"submit",class:"bg-green-600 text-white px-3 py-1 rounded"},"Save",-1)),t("button",{type:"button",onClick:e[13]||(e[13]=s=>o.editingTaskId=null),class:"bg-gray-400 text-white px-3 py-1 rounded"},"Cancel")])],32)])):(r(),i("div",st,[t("div",nt,[t("div",null,[t("h4",dt,d(l.title),1),t("p",it,d(l.detail),1)]),t("div",rt,[t("button",{onClick:s=>o.startEditTask(l),class:"text-blue-600 hover:underline text-sm font-semibold"},"Edit",8,at),t("button",{onClick:s=>o.deleteTask(l.id),class:"text-red-600 hover:underline text-sm font-semibold"},"Delete",8,ut)])]),t("div",bt,[t("span",null,"Status: "+d(l.status),1),t("span",null,"Priority: "+d(l.priority),1),t("span",null,"Due: "+d(l.due_date),1)])]))]))),128))]))])])}const mt=P(I,[["render",pt]]);export{mt as default};
